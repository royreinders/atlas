
            <div class="clr-row">
                <div class="clr-col-4">
                    <clr-datagrid [(clrDgSingleSelected)]="selected_finding" (clrDgSingleSelectedChange)="selectedFindingChanged($event)" [clrDgRowSelection]="true" class="datagrid-compact">
                        <clr-dg-action-bar>
                            <div class="btn-group">
                                <button class="btn" (click)="doSomething()">
                                    <clr-icon shape="plus"></clr-icon> Add Finding
                                </button>
                                <button class="btn" [disabled]="! selected_services" (click)="doSomething()">
                                    <clr-icon shape="pencil"></clr-icon> Edit Finding
                                </button>
                                <button class="btn" [disabled]="! selected_services" (click)="doSomething()">
                                    <clr-icon shape="trash"></clr-icon> Delete Finding
                                </button>
                            </div>
                        </clr-dg-action-bar>
                        <clr-dg-placeholder>No findings found!</clr-dg-placeholder>
                        <clr-dg-column [clrDgField]="'name'">Name<clr-dg-string-filter [clrDgStringFilter]="findingFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-row *clrDgItems="let finding of findings" [clrDgItem]="finding">
                            <clr-dg-cell>{{finding.name}}</clr-dg-cell>
                        </clr-dg-row>
                        <clr-dg-footer>
                            <clr-dg-pagination #finding_pagination [clrDgPageSize]="25">
                                {{finding_pagination.firstItem + 1}} - {{finding_pagination.lastItem + 1}} of
                                {{finding_pagination.totalItems}} findings
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>
                </div>
                <div class="clr-col">
                    <clr-datagrid [(clrDgSelected)]="selected_services" [clrDgRowSelection]="true" class="datagrid-compact">
                        <clr-dg-action-bar>
                            <div class="btn-group" >
                                <button [disabled]="!selected_services.length > 0" class="btn" (click)="doSomething()">
                                    <clr-icon shape="plus"></clr-icon> Add Service
                                </button>
                                <button [disabled]="!selected_services.length > 0" class="btn"(click)="doSomething()">
                                    <clr-icon shape="pencil"></clr-icon> Edit Service
                                </button>
                                <button [disabled]="!selected_services.length > 0" class="btn" (click)="doSomething()">
                                    <clr-icon shape="trash"></clr-icon> Delete Service
                                </button>
                            </div>
                            <div class="btn-group">
                            <button [disabled]="!selected_services.length > 0" class="btn" (click)="generatePocModal = true">
                                <clr-icon shape="play"></clr-icon> Generate PoC
                            </button>
                            </div>
                        </clr-dg-action-bar>
                        <clr-dg-placeholder>No services found!</clr-dg-placeholder>
                        <clr-dg-column [clrDgField]="'host'">IP<clr-dg-string-filter [clrDgStringFilter]="hostFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-column [clrDgField]="'port'">Port<clr-dg-string-filter [clrDgStringFilter]="portFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-column [clrDgField]="'name'">Type<clr-dg-string-filter [clrDgStringFilter]="typeFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-column [clrDgField]="'haspoc'">Has POC<clr-dg-string-filter [clrDgStringFilter]="typeFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-column [clrDgField]="'haspoc'">FP<clr-dg-string-filter [clrDgStringFilter]="typeFilter"></clr-dg-string-filter>
                        </clr-dg-column>
                        <clr-dg-column>PoC's</clr-dg-column>
                        <div *ngIf="selected_finding">
                            <clr-dg-row *clrDgItems="let service of finding_services" [clrDgItem]="service">
                                <clr-dg-cell>{{service.host}}</clr-dg-cell>
                                <clr-dg-cell>{{service.port}}</clr-dg-cell>
                                <clr-dg-cell>{{service.name}}</clr-dg-cell>
                                <clr-dg-cell>
                                    <div *ngIf="service.haspoc === 1; else no_poc">
                                        <clr-icon shape="check" (click)="setHasPoc(service)"></clr-icon>
                                    </div>
                                    <ng-template #no_poc>
                                        <clr-icon shape="times" (click)="setHasPoc(service)"></clr-icon>
                                    </ng-template>
                                </clr-dg-cell>
                                <clr-dg-cell>
                                    <div *ngIf="service.falsepositive === 1; else falsepositive">
                                        <clr-icon shape="check" (click)="setFalsePositive(service)"></clr-icon>
                                    </div>
                                    <ng-template #falsepositive>
                                        <clr-icon shape="times" (click)="setFalsePositive(service)"></clr-icon>
                                    </ng-template>
                                </clr-dg-cell>
                                <clr-dg-cell><clr-icon shape="pop-out" (click)="viewPocModal = true"></clr-icon></clr-dg-cell>
                            </clr-dg-row>
                        </div>
                        <clr-dg-footer>
                            <clr-dg-pagination #poc_pagination [clrDgPageSize]="25">
                                {{poc_pagination.firstItem + 1}} - {{poc_pagination.lastItem + 1}} of
                                {{poc_pagination.totalItems}} services
                            </clr-dg-pagination>
                        </clr-dg-footer>
                    </clr-datagrid>
                </div>
                
            </div>

<clr-modal [(clrModalOpen)]="generatePocModal" [clrModalSize]="'lg'">
    <h3 class="modal-title">Generate PoC</h3>
    <div class="modal-body">
        <clr-datagrid [(clrDgSingleSelected)]="selected_tool" (clrDgSingleSelectedChange)="SetThreads(selected_tool.threads)" [clrDgRowSelection]="true">>
            <clr-dg-placeholder>No tools found!</clr-dg-placeholder>
            <clr-dg-column [clrDgField]="'name'">Name
              <clr-dg-string-filter [clrDgStringFilter]="toolFilter"></clr-dg-string-filter>
            </clr-dg-column>
            <clr-dg-column [clrDgField]="'commandstring'">Commandstring
                <clr-dg-string-filter [clrDgStringFilter]="commandstringFilter"></clr-dg-string-filter>
              </clr-dg-column>
            <clr-dg-row *clrDgItems="let tool of tools" [clrDgItem]="tool">
              <clr-dg-cell>{{tool.name}}</clr-dg-cell>
              <clr-dg-cell>{{tool.commandstring}}</clr-dg-cell>
            </clr-dg-row>
            <clr-dg-footer>
              <clr-dg-pagination #tool_pagination [clrDgPageSize]="20">
                {{tool_pagination.firstItem + 1}} - {{tool_pagination.lastItem + 1}} of {{tool_pagination.totalItems}} tools
              </clr-dg-pagination>
            </clr-dg-footer>
          </clr-datagrid>
          <form clrForm>
            <section class="form-block">
                <clr-input-container>
                    <label>Threads</label><input clrInput [(ngModel)]="task_threads" name="threadsInput" type="text" id="requiredInput" placeholder="# of threads">
                    <clr-control-error>This field is required!</clr-control-error>
                </clr-input-container>
            </section>
        </form> 
    </div>
    <div class="modal-footer">
      <button type="button" [disabled]="!task_threads" class="btn btn-primary" (click)="generatePocModal = false; AddTask()">Ok</button>
    </div>
  </clr-modal>


  <clr-modal [(clrModalOpen)]="viewPocModal" [clrModalStaticBackdrop]="false" [clrModalSize]="'xl'">
        <div *ngIf="selected_finding">
    <h3 class="modal-title">PoC's for {{selected_finding}}</h3>
        </div>
    <div class="modal-body">
            <ul id="demoTabs" class="nav" role="tablist">
                    <li role="presentation" class="nav-item">
                        <button id="tab1" class="btn btn-link nav-link active" aria-controls="panel1"
                                aria-selected="true" type="button">Dashboard</button>
                    </li>
                    <li role="presentation" class="nav-item">
                        <button id="tab2" class="btn btn-link nav-link" aria-controls="panel2"
                                aria-selected="false" type="button">Management</button>
                    </li>
                    <li role="presentation" class="nav-item">
                        <button id="tab3" class="btn btn-link nav-link" aria-controls="panel3"
                                aria-selected="false" type="button">Cloud</button>
                    </li>
                </ul>
                <section id="panel1" role="tabpanel" aria-labelledby="tab1">
                    ...
                </section>
                <section id="panel2" role="tabpanel" aria-labelledby="tab2" aria-hidden="true">
                    ...
                </section>
                <section id="panel3" role="tabpanel" aria-labelledby="tab3" aria-hidden="true">
                    ...
                </section>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="viewPocModal = false">Ok</button>
    </div>
</clr-modal>
